(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-710d1c32"],{"0746":function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"zh-tw":{"title":"名醫會館"},"zh-cn":{"title":"名医会馆"}}'),delete e.options._Ctor}},"0ccb":function(e,t,n){var r=n("50c4"),a=n("1148"),i=n("1d80"),o=Math.ceil,s=function(e){return function(t,n,s){var c,u,d=String(i(t)),l=d.length,p=void 0===s?" ":String(s),f=r(n);return f<=l||""==p?d:(c=f-l,u=a.call(p,o(c/p.length)),u.length>c&&(u=u.slice(0,c)),e?d+u:u+d)}};e.exports={start:s(!1),end:s(!0)}},"5af8":function(e,t,n){"use strict";var r=n("0746"),a=n.n(r);t["default"]=a.a},"64e5":function(e,t,n){"use strict";var r=n("d039"),a=n("0ccb").start,i=Math.abs,o=Date.prototype,s=o.getTime,c=o.toISOString;e.exports=r((function(){return"0385-07-25T07:06:39.999Z"!=c.call(new Date(-50000000000001))}))||!r((function(){c.call(new Date(NaN))}))?function(){if(!isFinite(s.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),n=e.getUTCMilliseconds(),r=t<0?"-":t>9999?"+":"";return r+a(i(t),r?6:4,0)+"-"+a(e.getUTCMonth()+1,2,0)+"-"+a(e.getUTCDate(),2,0)+"T"+a(e.getUTCHours(),2,0)+":"+a(e.getUTCMinutes(),2,0)+":"+a(e.getUTCSeconds(),2,0)+"."+a(n,3,0)+"Z"}:c},8617:function(e,t,n){},a4d8:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"doc-list pt-2"},[n("van-overlay",{staticStyle:{"z-index":"9999","text-align":"center"},attrs:{show:e.loadingApi}},[n("van-loading",{attrs:{type:"spinner"}})],1),n("header",[e._v(e._s(e.searchBy.includes("熱門")?"熱門":e.searchBy)+"名醫")]),e._l(e.docs,(function(t,r){return n("main",{key:r,staticClass:"doc-item mt-1"},[n("van-card",{attrs:{price:t.price,currency:"NT",desc:e.getDesc(t),title:e.getTitle(t),thumb:e.getImgPath(t,r)},on:{click:function(n){return e.viewDetail(t)}},scopedSlots:e._u([{key:"tags",fn:function(){return[n("van-tag",{attrs:{plain:"",type:"danger"}},[e._v("可預約數量剩餘("+e._s(e.getBooksNum())+")")])]},proxy:!0},{key:"footer",fn:function(){return[n("van-button",{staticClass:"mr-2",attrs:{size:"small"},on:{click:function(n){return n.stopPropagation(),e.addCollection(t)}}},[e._v("收藏")]),e.isOrderAble(t)?n("van-button",{staticClass:"mr-2",attrs:{size:"small",type:"info"},on:{click:function(n){return n.stopPropagation(),e.book(t)}}},[e._v("預約")]):n("van-tag",{staticClass:"mr-2",staticStyle:{transform:"translate3d(4px,5px,0)"},attrs:{plain:"",type:"primary"}},[e._v("您已預約: "+e._s(e.getWaitStatus(t)))])]},proxy:!0}],null,!0)})],1)}))],2)},a=[],i=(n("a4d3"),n("e01a"),n("99af"),n("4de4"),n("7db0"),n("accc"),n("0d03"),n("b0c0"),n("2909")),o=(n("96cf"),n("1da1")),s=n("2b0e"),c=n("3aec"),u={name:"docList",data:function(){return{id:"",name:"",docs:[],cates:[],skip:0,cat:"",searchBy:"",myPreviousOrders:[],loadingApi:!1,jsonOutput:"",favList:[]}},computed:{unFinishOrders:function(){return this.myPreviousOrders.filter((function(e){return"finish"!=e.status}))}},methods:{getMyFav:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n="userId="+window.lineId,t.next=3,c["a"].getMyFav(n);case 3:r=t.sent,a=r.items,e.favList=a;case 6:case"end":return t.stop()}}),t)})))()},isOrderAble:function(e){return!this.unFinishOrders.find((function(t){return t.orderPhoneNum==window.lineId&&t.doctorPhone==e.phone}))},getWaitStatus:function(e){var t=this.unFinishOrders.find((function(t){return t.orderPhoneNum==window.lineId&&t.doctorPhone==e.phone})).status;return"process"==t?"醫師處理中":"等待醫師回覆中"},addCollection:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r,a,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a={userId:window.lineId,doctorPhone:e.phone},i=null===(r=t.favList)||void 0===r?void 0:r.find((function(t){return t.doctorPhone==e.phone})),!i){n.next=5;break}return s["a"].$toast.success("您已收藏成功"),n.abrupt("return");case 5:return n.prev=5,n.next=8,c["a"].addMyFav(a);case 8:s["a"].$toast.success("您已收藏成功"),n.next=14;break;case 11:n.prev=11,n.t0=n["catch"](5),s["a"].$toast.error("收藏 Fail");case 14:case"end":return n.stop()}}),n,null,[[5,11]])})))()},book:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r,a,o,u,d;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return window.orderedDocPhone=e.phone,r={lineClientDisplayName:c["c"].lineProfile.displayName?c["c"].lineProfile.displayName:"DTC Tester",realName:e.name,orderPhoneNum:window.lineId,paidAmount:e.price,orderStatus:"waiting",orderDate:(new Date).toISOString(),doctorPhone:e.phone,inqueryCate:1,cusUnreadMsg:1,totalMsg:1,message:e.cid<c["c"].MIN_NON_CANCER_NUM?[{docComment:"需要您的報告,請您用郵件寄出",commentAt:(new Date).toISOString()}]:[]},n.prev=2,t.loadingApi=!0,n.next=6,c["a"].addOrder(r);case 6:return n.sent,s["a"].$toast.success("您已預約成功"),n.next=10,t.getOrderHistory();case 10:return t.docs=Object(i["a"])(t.docs),o=(null===(a=e.orderPhoneNum)||void 0===a?void 0:a.length)>10?e.orderPhoneNum:"U2a9bc2736efe3c6a0d361fef34efdb83",u={id:o},d="你有一筆新訂單NT".concat(r.paidAmount,"元,客戶名稱: ").concat(r.lineClientDisplayName),u.msg=d,n.next=17,c["a"].lineMsg(u);case 17:n.next=22;break;case 19:n.prev=19,n.t0=n["catch"](2),s["a"].$toast.error("order fail"+n.t0);case 22:return n.prev=22,window.orderedDocPhone="",t.loadingApi=!1,n.finish(22);case 26:case"end":return n.stop()}}),n,null,[[2,19,22,26]])})))()},getBooksNum:function(){return 3},viewDetail:function(e){window.scrollTo({top:0,behavior:"smooth"});var t=this.isOrderAble(e);e.status=t?"waiting":"finish",c["c"].selectedDoctor=e,this.$router.push("doctordetails")},getDesc:function(e){return"擅長: "+e.description},getTitle:function(e){return e.name+" | "+e.hospital+" | "+e.title},getImgPath:function(e,t){return c["c"].imgPrefix+e.cover.url},getDocList:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,n=e.id?"doctors?cid_eq="+e.id:"doctors?_limit=30&_start=".concat(e.skip),t.next=4,axios.get(n);case 4:e.docs=t.sent,t.next=9;break;case 7:t.prev=7,t.t0=t["catch"](0);case 9:case"end":return t.stop()}}),t,null,[[0,7]])})))()},getOrderHistory:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(window.lineId){t.next=3;break}return e.myPreviousOrders=[],t.abrupt("return");case 3:return n="orderPhoneNum_eq="+window.lineId,t.next=6,c["a"].getOrders(n);case 6:r=t.sent,r.count,a=r.items,e.myPreviousOrders=a;case 10:case"end":return t.stop()}}),t)})))()}},mounted:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.$route.query,r=n.id,a=n.searchBy,e.id=+r,e.name=a,e.searchBy=a||"熱門醫生",t.prev=4,e.loadingApi=!0,t.next=8,e.getOrderHistory();case 8:return t.next=10,e.getDocList();case 10:return t.next=12,c["a"].getCancerTypes();case 12:e.cates=t.sent,t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](4),alert("error "+t.t0);case 18:return t.prev=18,e.loadingApi=!1,t.finish(18);case 21:e.getMyFav();case 22:case"end":return t.stop()}}),t,null,[[4,15,18,21]])})))()},watch:{}},d=u,l=(n("dd90"),n("2877")),p=n("5af8"),f=Object(l["a"])(d,r,a,!1,null,"32708b52",null);"function"===typeof p["default"]&&Object(p["default"])(f);t["default"]=f.exports},accc:function(e,t,n){var r=n("23e7"),a=n("64e5");r({target:"Date",proto:!0,forced:Date.prototype.toISOString!==a},{toISOString:a})},dd90:function(e,t,n){"use strict";n("8617")}}]);
//# sourceMappingURL=chunk-710d1c32.39af1605.js.map