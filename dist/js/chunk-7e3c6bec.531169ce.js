(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7e3c6bec"],{"27d2":function(e,t,n){},"8d5b":function(e,t,n){"use strict";n("27d2")},"9b24":function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"zh-tw":{"title":"名醫會館"},"zh-cn":{"title":"名医会馆"}}'),delete e.options._Ctor}},a55b:function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"dtc-login",style:e.isLogin?"":"justify-content: center;"},[e.isLogin?n("nav",{directives:[{name:"show",rawName:"v-show",value:!e.isDoc,expression:"!isDoc"}],staticClass:"login"},[n("h2",[e._v(" 我的健康中心 "),n("span",{staticClass:"mt-2",staticStyle:{"font-size":"13px","text-align":"left"},on:{click:e.logout}},[e._v("用戶: "+e._s(e.myPhone)+"..."),n("i",{staticClass:"fas fa-sign-out-alt ml-2"},[e._v("登出")])])]),n("van-cell-group",e._l(e.titles,(function(t,o){return n("van-cell",{key:t,attrs:{style2:"background:#e3e4f9 !important;color:black;",label:e.labels[o],title:t,size:"large"},on:{click:function(n){return e.open(t,o)}}})})),1)],1):n("nav",[n("PhoneLogin")],1)])},r=[],a=(n("caad"),n("fb6a"),n("2532"),n("3aec")),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"dtc-phone"},[n("van-overlay",{staticStyle:{"z-index":"9999"},attrs:{show:e.showMask},on:{click:function(t){e.showMask=!1}}},[n("van-loading",{staticClass:"mt-4",attrs:{type:"spinner"}})],1),n("main",[n("h2",[e._m(0),e._v(e._s(e.$t("健康通行證"))+" ")]),n("div",{staticClass:"phone-div"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.phone,expression:"phone"}],attrs:{placeholder:"請輸入手機號碼",minlength:"10",maxlength:"10"},domProps:{value:e.phone},on:{input:function(t){t.target.composing||(e.phone=t.target.value)}}})]),n("div",{staticClass:"phone-div mt-3 short-code"},[n("div",{directives:[{name:"show",rawName:"v-show",value:10==e.phone.length,expression:"phone.length == 10"}],staticClass:"code-btn",on:{click:e.register}},[e._v("獲取短信驗證碼")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.code,expression:"code"},{name:"show",rawName:"v-show",value:e.needCode,expression:"needCode"}],attrs:{placeholder:"請輸入短信驗證碼",minlength:"6",maxlength:"6"},domProps:{value:e.code},on:{input:function(t){t.target.composing||(e.code=t.target.value)}}})]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.enableLogin,expression:"enableLogin"}],staticClass:"login",on:{click:e.confirmSMSCode}},[e._v("登入")])]),n("button",{attrs:{id:e.recaptchaDomId,note:"google requried this invisable div"}})],1)},i=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"mr-3"},[n("i",{staticClass:"fas fa-sign-in-alt"})])}],c=(n("96cf"),n("1da1")),u=n("2b0e"),l={name:"login",data:function(){return{showKeyboard:!0,phone:"0928012588",needCode:"",code:"654321",confirmationSMSCodeResult:"",user:"",jwt:"",recaptchaDomId:"sign-in-button",showMask:!1}},computed:{isLogin:function(){return sessionStorage.isLogin||a["c"].isLogin},enableLogin:function(){return this.code&&6==this.code.length&&!isNaN(this.code)&&this.needCode}},methods:{register:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.showMask=!0,t.next=4,a["a"].registerByMobilePhone("+886".concat(e.phone),e.recaptchaDomId);case 4:e.confirmationSMSCodeResult=t.sent,e.needCode=!0,e.showMask=!1,t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](0),u["a"].$toast.error("請檢查電話號碼是否正確"),e.showMask=!1;case 13:case"end":return t.stop()}}),t,null,[[0,9]])})))()},connectWithStrapi:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,o,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.loginStrapi();case 3:if(n=t.sent,o=n.jwt,e.jwt=o,o){t.next=12;break}return t.next=9,e.registerStrapi()["catch"]((function(e){alert("something wrong")}));case 9:r=t.sent,s=r.jwt,e.jwt=s;case 12:sessionStorage.token=e.jwt,localStorage.token=e.jwt,e.user=JSON.stringify(e.user,null,2),e.showMask=!1,a["b"].login(e.phone),t.next=23;break;case 19:t.prev=19,t.t0=t["catch"](0),e.showMask=!1,u["a"].$toast.error("請檢查驗證號碼"+t.t0);case 23:case"end":return t.stop()}}),t,null,[[0,19]])})))()},confirmSMSCode:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.showMask=!0,t.next=4,e.confirmationSMSCodeResult.confirm(e.code);case 4:e.connectWithStrapi(),t.next=11;break;case 7:t.prev=7,t.t0=t["catch"](0),location.reload(),u["a"].$toast.error("請檢查驗證號碼"+t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})))()},registerStrapi:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,o,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,a["a"].registerStrapi({username:e.phone,password:a["c"].PASSWORD});case 2:if(n=t.sent,o=n.user,r=n.jwt,!r){t.next=9;break}return e.user=o,o.isDoctor&&(alert("this is not for doctor; you will be logout at once"),a["b"].logout()),t.abrupt("return",{jwt:r});case 9:case"end":return t.stop()}}),t)})))()},loginStrapi:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,o,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,a["a"].loginStrapi({identifier:e.phone,password:a["c"].PASSWORD});case 3:return n=t.sent,o=n.user,r=n.jwt,r&&(e.user=o,o.isDoctor&&(alert("this is not for doctor; you will be logout at once"),a["b"].logout())),t.abrupt("return",{jwt:r});case 10:return t.prev=10,t.t0=t["catch"](0),t.abrupt("return",{jwt:""});case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()}},mounted:function(){}},p=l,h=(n("abf4"),n("2877")),d=n("ef12"),f=Object(h["a"])(p,s,i,!1,null,"167e57e4",null);"function"===typeof d["default"]&&Object(d["default"])(f);var g=f.exports,m=["預約紀錄(6)","提問(5)","意見反饋(1)","我的收藏(2)","系統設置"],v=["共有6筆記錄","你有一則已答覆","廠商有兩則反饋","你有兩個收藏","客製化個人設定"],w={name:"loginHome",data:function(){return{titles:m,labels:v,phone:sessionStorage.phone,idDoc:location.href.includes("isdoc=true")}},computed:{isLogin:function(){return sessionStorage.isLogin||a["c"].isLogin},myPhone:function(){var e=sessionStorage.phone?sessionStorage.phone.slice(0,6):"";return e}},components:{PhoneLogin:g},methods:{open:function(e,t){0==t&&this.$router.push("myorderlist")},logout:function(){a["b"].logout(),a["c"].activeTab=0,this.$router.push("home"),location.reload(!0)}},mounted:function(){a["c"].activeTab=3},watch:{}},b=w,k=(n("8d5b"),n("edc3")),S=Object(h["a"])(b,o,r,!1,null,"3806ce43",null);"function"===typeof k["default"]&&Object(k["default"])(S);t["default"]=S.exports},a86c:function(e,t,n){},abf4:function(e,t,n){"use strict";n("a86c")},b6d8:function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"zh-tw":{"登入":"登入","健康通行證":"登入健康通行證","手機號碼":"手機號碼","24小時不限次數與醫生面對面諮詢立即開通":"24小時不限次數與醫生面對面諮詢立即開通"},"zh-cn":{"登入":"登入","健康通行證":"登入健康通行證","手機號碼":"手機號碼","24小時不限次數與醫生面對面諮詢立即開通":"24小時不限次數與醫生面對面諮詢立即開通"}}'),delete e.options._Ctor}},edc3:function(e,t,n){"use strict";var o=n("9b24"),r=n.n(o);t["default"]=r.a},ef12:function(e,t,n){"use strict";var o=n("b6d8"),r=n.n(o);t["default"]=r.a}}]);
//# sourceMappingURL=chunk-7e3c6bec.531169ce.js.map