(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-be733104"],{"0746":function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"zh-tw":{"title":"名醫會館"},"zh-cn":{"title":"名医会馆"}}'),delete e.options._Ctor}},"0ccb":function(e,t,n){var r=n("50c4"),i=n("1148"),a=n("1d80"),o=Math.ceil,s=function(e){return function(t,n,s){var c,u,d=String(a(t)),l=d.length,p=void 0===s?" ":String(s),h=r(n);return h<=l||""==p?d:(c=h-l,u=i.call(p,o(c/p.length)),u.length>c&&(u=u.slice(0,c)),e?d+u:u+d)}};e.exports={start:s(!1),end:s(!0)}},"2a70":function(e,t,n){"use strict";n("99fb")},"5af8":function(e,t,n){"use strict";var r=n("0746"),i=n.n(r);t["default"]=i.a},"64e5":function(e,t,n){"use strict";var r=n("d039"),i=n("0ccb").start,a=Math.abs,o=Date.prototype,s=o.getTime,c=o.toISOString;e.exports=r((function(){return"0385-07-25T07:06:39.999Z"!=c.call(new Date(-50000000000001))}))||!r((function(){c.call(new Date(NaN))}))?function(){if(!isFinite(s.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),n=e.getUTCMilliseconds(),r=t<0?"-":t>9999?"+":"";return r+i(a(t),r?6:4,0)+"-"+i(e.getUTCMonth()+1,2,0)+"-"+i(e.getUTCDate(),2,0)+"T"+i(e.getUTCHours(),2,0)+":"+i(e.getUTCMinutes(),2,0)+":"+i(e.getUTCSeconds(),2,0)+"."+i(n,3,0)+"Z"}:c},"99fb":function(e,t,n){},a4d8:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"doc-list pt-2"},[n("van-overlay",{staticStyle:{"z-index":"9999","text-align":"center"},attrs:{show:e.loadingApi}},[n("van-loading",{attrs:{type:"spinner"}})],1),n("header",[e._v("快速找名醫")]),n("van-search",{staticClass:"mx-4 mt-2",attrs:{background:"white",shape:"round",placeholder:"醫院 | 醫生名 | 病名"},model:{value:e.searchBy,callback:function(t){e.searchBy=t},expression:"searchBy"}}),e._l(e.docs,(function(t,r){return n("main",{key:r,staticClass:"doc-item mt-1"},[n("van-card",{attrs:{price:t.price,currency:"NT",desc:e.getDesc(t),title:e.getTitle(t),thumb:e.getImgPath(t,r)},on:{click:function(n){return e.viewDetail(t)}},scopedSlots:e._u([{key:"tags",fn:function(){return[n("van-tag",{attrs:{plain:"",type:"danger"}},[e._v("可預約數量剩餘("+e._s(e.getBooksNum())+")")])]},proxy:!0},{key:"footer",fn:function(){return[n("van-button",{staticClass:"mr-2",attrs:{size:"small"}},[e._v("收藏")]),e.isOrderAble(t)?n("van-button",{staticClass:"mr-2",attrs:{size:"small",type:"info"},on:{click:function(n){return n.stopPropagation(),e.book(t)}}},[e._v("預約")]):n("van-tag",{staticClass:"mr-2",staticStyle:{transform:"translate3d(4px,5px,0)"},attrs:{plain:"",type:"primary"}},[e._v("您已預約: "+e._s(e.getWaitStatus(t)))])]},proxy:!0}],null,!0)})],1)}))],2)},i=[],a=(n("a4d3"),n("e01a"),n("4de4"),n("7db0"),n("accc"),n("0d03"),n("b0c0"),n("2909")),o=(n("96cf"),n("1da1")),s=n("2b0e"),c=n("3aec"),u={name:"docList",data:function(){return{id:"",name:"",docs:[],cates:[],skip:0,cat:"",searchBy:"",myPreviousOrders:[],loadingApi:!1,jsonOutput:""}},computed:{unFinishOrders:function(){return this.myPreviousOrders.filter((function(e){return"finish"!=e.status}))}},methods:{isOrderAble:function(e){return!this.unFinishOrders.find((function(t){return t.orderPhoneNum==window.lineId&&t.doctorPhone==e.phone}))},getWaitStatus:function(e){var t=this.unFinishOrders.find((function(t){return t.orderPhoneNum==window.lineId&&t.doctorPhone==e.phone})).status;return"process"==t?"醫師處理中":"等待醫師回覆中"},book:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r,i,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return window.orderedDocPhone=e.phone,r={orderPhoneNum:window.lineId,paidAmount:e.price,orderStatus:"waiting",orderDate:(new Date).toISOString(),doctorPhone:e.phone,inqueryCate:1,cusUnreadMsg:1,totalMsg:1,message:e.cid<c["c"].MIN_NON_CANCER_NUM?[{docComment:"需要您的報告,請您用郵件寄出",commentAt:(new Date).toISOString()}]:[]},n.prev=2,t.loadingApi=!0,n.next=6,c["a"].addOrder(r);case 6:return i=n.sent,s["a"].$toast.success("您已預約成功"),n.next=10,t.getOrderHistory();case 10:t.docs=Object(a["a"])(t.docs),o={senderPhone:window.lineId,receivePhone:e.phone,orderId:i.id,type:"newOrder"},c["a"].sendPushMsg(o),n.next=18;break;case 15:n.prev=15,n.t0=n["catch"](2),s["a"].$toast.error("order fail"+n.t0);case 18:return n.prev=18,window.orderedDocPhone="",t.loadingApi=!1,n.finish(18);case 22:case"end":return n.stop()}}),n,null,[[2,15,18,22]])})))()},getBooksNum:function(){return 3},viewDetail:function(e){window.scrollTo({top:0,behavior:"smooth"});var t=this.isOrderAble(e);e.status=t?"waiting":"finish",c["c"].selectedDoctor=e,this.$router.push("doctordetails")},getDesc:function(e){return"擅長: "+e.description},getTitle:function(e){return e.name+" | "+e.hospital+" | "+e.title},getImgPath:function(e,t){return c["c"].imgPrefix+e.cover.url},getDocList:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,n=e.id?"doctors?cid_eq="+e.id:"doctors?_limit=30&_start=".concat(e.skip),t.next=4,axios.get(n);case 4:e.docs=t.sent,t.next=9;break;case 7:t.prev=7,t.t0=t["catch"](0);case 9:case"end":return t.stop()}}),t,null,[[0,7]])})))()},getOrderHistory:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(window.lineId){t.next=3;break}return e.myPreviousOrders=[],t.abrupt("return");case 3:return n="orderPhoneNum_eq="+window.lineId,t.next=6,c["a"].getOrders(n);case 6:r=t.sent,r.count,i=r.items,e.myPreviousOrders=i;case 10:case"end":return t.stop()}}),t)})))()}},mounted:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.$route.query,r=n.id,i=n.searchBy,e.id=+r,e.name=i,e.searchBy=i||"熱門醫生",t.prev=4,e.loadingApi=!0,t.next=8,e.getOrderHistory();case 8:return t.next=10,e.getDocList();case 10:return t.next=12,c["a"].getCancerTypes();case 12:e.cates=t.sent,t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](4),alert("error "+t.t0);case 18:return t.prev=18,e.loadingApi=!1,t.finish(18);case 21:case"end":return t.stop()}}),t,null,[[4,15,18,21]])})))()},watch:{}},d=u,l=(n("2a70"),n("2877")),p=n("5af8"),h=Object(l["a"])(d,r,i,!1,null,"73a34bbf",null);"function"===typeof p["default"]&&Object(p["default"])(h);t["default"]=h.exports},accc:function(e,t,n){var r=n("23e7"),i=n("64e5");r({target:"Date",proto:!0,forced:Date.prototype.toISOString!==i},{toISOString:i})}}]);
//# sourceMappingURL=chunk-be733104.b7012c12.js.map