(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-697bbb62"],{"0ccb":function(e,t,n){var r=n("50c4"),a=n("1148"),i=n("1d80"),o=Math.ceil,c=function(e){return function(t,n,c){var s,u,l=String(i(t)),d=l.length,p=void 0===c?" ":String(c),m=r(n);return m<=d||""==p?l:(s=m-d,u=a.call(p,o(s/p.length)),u.length>s&&(u=u.slice(0,s)),e?l+u:u+l)}};e.exports={start:c(!1),end:c(!0)}},1175:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"doc-list pt-2"},[n("van-overlay",{staticStyle:{"z-index":"9999","text-align":"center"},attrs:{show:e.loadingApi}},[n("van-loading",{attrs:{type:"spinner"}})],1),n("header",[e._v("預約線上名醫")]),e._l(e.docs,(function(t,r){return n("main",{key:r,staticClass:"doc-item mt-1"},[n("van-card",{attrs:{price:t.price,currency:"NT",desc:e.getDesc(t),title:e.getTitle(t),thumb:e.getImgPath(t,r)},on:{click:function(n){return e.viewDetail(t)}}})],1)})),n("h5",{staticStyle:{color:"black","margin-top":"10px",transform:"translateX(10px)"}},[e._v("請填寫基本資料")]),n("van-form",{on:{submit:e.submitCard,failed:e.onFailedInput}},[n("van-field",{attrs:{name:"用户名",label:"用户名",placeholder:"請填寫您的真實姓名",rules:[{required:!0,message:"請填寫您的真實姓名"}]},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),n("van-field",{attrs:{type:"number",name:"手機",label:"手機號碼",placeholder:"範例: 0911612559",rules:[{validator:e.validator,message:"請填寫正確手機號碼"}]},model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}}),n("h5",{staticStyle:{color:"black","margin-top":"10px",transform:"translateX(10px)"}},[e._v("信用卡")]),n("div",{attrs:{id:"tappay-container"}}),n("div",{staticStyle:{margin:"16px"}},[n("van-button",{attrs:{disabled:!e.enableSubmitBtn,round:"",block:"",type:"info","native-type":"submit"}},[e._v("提交")])],1)],1)],2)},a=[],i=(n("a4d3"),n("e01a"),n("99af"),n("4de4"),n("fb6a"),n("accc"),n("0d03"),n("b0c0"),n("4795"),n("2909")),o=(n("96cf"),n("1da1")),c=n("2b0e"),s=n("3aec"),u={name:"docList",data:function(){return{id:"",docs:[],cates:[],skip:0,cat:"",searchBy:"",myPreviousOrders:[],loadingApi:!1,jsonOutput:"",favList:[],username:"",phone:"",canGetPrime:!1,failInput:!1}},computed:{unFinishOrders:function(){return this.myPreviousOrders.filter((function(e){return"finish"!=e.status}))},enableSubmitBtn:function(){return this.canGetPrime&&this.phone&&this.username&&!this.failInput}},methods:{onFailedInput:function(e){this.failInput=!!e},validator:function(e){return/0\d{9}/.test(e)},submitCard:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.loadingApi=!0,n=e.docs[0],r={},TPDirect.card.getPrime(function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(a){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r.partner_key=s["c"].tappayId,r.prime="".concat(a.card.prime),r.amount=+n.price,r.merchant_id="pluscda_CTBC",r.details=n.name,i={phone_number:"+886"+e.phone.slice(1),name:e.username,email:"",zip_code:"",address:"",national_id:""},r.cardholder=i,t.prev=7,t.next=10,s["a"].confirmPayOnline(r);case 10:e.book(n),t.next=17;break;case 13:t.prev=13,t.t0=t["catch"](7),e.loadingApi=!1,alert(""+t.t0);case 17:case"end":return t.stop()}}),t,null,[[7,13]])})));return function(e){return t.apply(this,arguments)}}());case 4:case"end":return t.stop()}}),t)})))()},book:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r,a,o,u,l,d,p,m;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return window.orderedDocPhone=e.phone,localStorage.username=t.username,localStorage.phone=t.phone,r={clientLinePhone:t.phone,lineClientDisplayName:t.username,realName:e.name,orderPhoneNum:window.lineId,paidAmount:e.price,orderStatus:"waiting",orderDate:(new Date).toISOString(),doctorPhone:e.phone,inqueryCate:0,cusUnreadMsg:0,totalMsg:0,message:[]},n.prev=4,t.loadingApi=!0,n.next=8,s["a"].addOrder(r);case 8:return o=n.sent,c["a"].$toast.success("您已預約成功"),n.next=12,t.getOrderHistory();case 12:return t.docs=Object(i["a"])(t.docs),u=(null===(a=e.orderPhoneNum)||void 0===a?void 0:a.length)>10?e.orderPhoneNum:"U60dea79b6fcd77b9c9e3eeb21fcce0a1",l={id:u},d=s["c"].lineUrl+"orderid="+o.id,p="你有一筆新訂單NT".concat(r.paidAmount,"元\n客戶名稱: ").concat(r.lineClientDisplayName,"\n客戶手機:").concat(t.phone,"\n\n").concat(d),l.msg=p,n.next=20,s["a"].lineMsg(l);case 20:if(!(e.cid<s["c"].MIN_NON_CANCER_NUM)){n.next=25;break}return m={id:window.lineId},m.msg="需要您的報告,請您用郵件掛號寄出:\n新北市中和區中正路866號15F\n\n合華科技股份有限公司",n.next=25,s["a"].lineSelf(m);case 25:t.$router.push("/myorderlist"),n.next=31;break;case 28:n.prev=28,n.t0=n["catch"](4),c["a"].$toast.error("order fail"+n.t0);case 31:return n.prev=31,window.orderedDocPhone="",t.loadingApi=!1,n.finish(31);case 35:case"end":return n.stop()}}),n,null,[[4,28,31,35]])})))()},getBooksNum:function(){return 3},viewDetail:function(e){window.scrollTo({top:0,behavior:"smooth"});var t=this.isOrderAble(e);e.status=t?"waiting":"finish",s["c"].selectedDoctor=e,this.$router.push("doctordetails")},getDesc:function(e){return"擅長: "+e.description},getTitle:function(e){return e.name+" | "+e.hospital+" | "+e.title},getImgPath:function(e,t){return s["c"].imgPrefix+e.cover.url},getDocList:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:try{e.docs=[s["c"].bookItem]}catch(n){}case 1:case"end":return t.stop()}}),t)})))()},getOrderHistory:function(){return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},constructTapPay:function(){var e=this;s["a"].initTapPay("#tappay-container"),TPDirect.card.onUpdate(function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.canGetPrime=n.canGetPrime;case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},mounted:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.username=localStorage.username,e.phone=localStorage.phone,t.prev=2,e.loadingApi=!0,t.next=6,e.getDocList();case 6:return t.next=8,s["a"].getCancerTypes();case 8:e.cates=t.sent,setTimeout((function(){return e.constructTapPay()}),800),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](2),alert("error "+t.t0);case 15:return t.prev=15,e.loadingApi=!1,t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[2,12,15,18]])})))()},watch:{}},l=u,d=(n("8715"),n("2877")),p=n("d178"),m=Object(d["a"])(l,r,a,!1,null,"223ab9b4",null);"function"===typeof p["default"]&&Object(p["default"])(m);t["default"]=m.exports},3654:function(e,t){e.exports=function(e){e.options.__i18n=e.options.__i18n||[],e.options.__i18n.push('{"zh-tw":{"title":"名醫會館"},"zh-cn":{"title":"名医会馆"}}'),delete e.options._Ctor}},"64e5":function(e,t,n){"use strict";var r=n("d039"),a=n("0ccb").start,i=Math.abs,o=Date.prototype,c=o.getTime,s=o.toISOString;e.exports=r((function(){return"0385-07-25T07:06:39.999Z"!=s.call(new Date(-50000000000001))}))||!r((function(){s.call(new Date(NaN))}))?function(){if(!isFinite(c.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),n=e.getUTCMilliseconds(),r=t<0?"-":t>9999?"+":"";return r+a(i(t),r?6:4,0)+"-"+a(e.getUTCMonth()+1,2,0)+"-"+a(e.getUTCDate(),2,0)+"T"+a(e.getUTCHours(),2,0)+":"+a(e.getUTCMinutes(),2,0)+":"+a(e.getUTCSeconds(),2,0)+"."+a(n,3,0)+"Z"}:s},8715:function(e,t,n){"use strict";n("ae9a")},accc:function(e,t,n){var r=n("23e7"),a=n("64e5");r({target:"Date",proto:!0,forced:Date.prototype.toISOString!==a},{toISOString:a})},ae9a:function(e,t,n){},d178:function(e,t,n){"use strict";var r=n("3654"),a=n.n(r);t["default"]=a.a}}]);
//# sourceMappingURL=chunk-697bbb62.b1ab7f2e.js.map