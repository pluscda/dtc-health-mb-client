(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8fc294f4"],{"0746":function(t,e){t.exports=function(t){t.options.__i18n=t.options.__i18n||[],t.options.__i18n.push('{"zh-tw":{"title":"名醫會館"},"zh-cn":{"title":"名医会馆"}}'),delete t.options._Ctor}},"0ccb":function(t,e,n){var r=n("50c4"),a=n("1148"),i=n("1d80"),o=Math.ceil,s=function(t){return function(e,n,s){var c,u,d=String(i(e)),l=d.length,p=void 0===s?" ":String(s),f=r(n);return f<=l||""==p?d:(c=f-l,u=a.call(p,o(c/p.length)),u.length>c&&(u=u.slice(0,c)),t?d+u:u+d)}};t.exports={start:s(!1),end:s(!0)}},"52ec":function(t,e,n){"use strict";n("d326")},"5af8":function(t,e,n){"use strict";var r=n("0746"),a=n.n(r);e["default"]=a.a},"64e5":function(t,e,n){"use strict";var r=n("d039"),a=n("0ccb").start,i=Math.abs,o=Date.prototype,s=o.getTime,c=o.toISOString;t.exports=r((function(){return"0385-07-25T07:06:39.999Z"!=c.call(new Date(-50000000000001))}))||!r((function(){c.call(new Date(NaN))}))?function(){if(!isFinite(s.call(this)))throw RangeError("Invalid time value");var t=this,e=t.getUTCFullYear(),n=t.getUTCMilliseconds(),r=e<0?"-":e>9999?"+":"";return r+a(i(e),r?6:4,0)+"-"+a(t.getUTCMonth()+1,2,0)+"-"+a(t.getUTCDate(),2,0)+"T"+a(t.getUTCHours(),2,0)+":"+a(t.getUTCMinutes(),2,0)+":"+a(t.getUTCSeconds(),2,0)+"."+a(n,3,0)+"Z"}:c},a4d8:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"doc-list pt-2"},[n("van-overlay",{staticStyle:{"z-index":"9999","text-align":"center"},attrs:{show:t.loadingApi}},[n("van-loading",{attrs:{type:"spinner"}})],1),n("header",[t._v(t._s(t.searchBy.includes("熱門")?"熱門":t.searchBy)+"名醫")]),t._l(t.docs,(function(e,r){return n("main",{key:r,staticClass:"doc-item mt-1"},[n("van-card",{attrs:{price:e.price,currency:"NT",desc:t.getDesc(e),title:t.getTitle(e),thumb:t.getImgPath(e,r)},on:{click:function(n){return t.viewDetail(e)}},scopedSlots:t._u([{key:"tags",fn:function(){return[n("van-tag",{attrs:{plain:"",type:"danger"}},[t._v("可預約數量剩餘("+t._s(t.getBooksNum())+")")])]},proxy:!0},{key:"footer",fn:function(){return[n("van-button",{staticClass:"mr-2",attrs:{size:"small"},on:{click:function(n){return n.stopPropagation(),t.addCollection(e)}}},[t._v("收藏")]),t.isOrderAble(e)?n("van-button",{staticClass:"mr-2",attrs:{size:"small",type:"info"},on:{click:function(n){return n.stopPropagation(),t.book(e)}}},[t._v("預約")]):n("van-tag",{staticClass:"mr-2",staticStyle:{transform:"translate3d(4px,5px,0)"},attrs:{plain:"",type:"primary"}},[t._v("您已預約: "+t._s(t.getWaitStatus(e)))])]},proxy:!0}],null,!0)})],1)}))],2)},a=[],i=(n("a4d3"),n("e01a"),n("99af"),n("4de4"),n("7db0"),n("accc"),n("0d03"),n("b0c0"),n("2909")),o=(n("96cf"),n("1da1")),s=n("2b0e"),c=n("3aec"),u={name:"docList",data:function(){return{id:"",name:"",docs:[],cates:[],skip:0,cat:"",searchBy:"",myPreviousOrders:[],loadingApi:!1,jsonOutput:"",favList:[]}},computed:{unFinishOrders:function(){return this.myPreviousOrders.filter((function(t){return"finish"!=t.status}))}},methods:{getMyFav:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var n,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n="userId="+window.lineId,e.next=3,c["a"].getMyFav(n);case 3:r=e.sent,a=r.items,t.favList=a;case 6:case"end":return e.stop()}}),e)})))()},isOrderAble:function(t){return!this.unFinishOrders.find((function(e){return e.orderPhoneNum==window.lineId&&e.doctorPhone==t.phone}))},getWaitStatus:function(t){var e=this.unFinishOrders.find((function(e){return e.orderPhoneNum==window.lineId&&e.doctorPhone==t.phone})).status;return"process"==e?"醫師處理中":"等待醫師回覆中"},addCollection:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r,a,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a={userId:window.lineId,doctorPhone:t.phone},i=null===(r=e.favList)||void 0===r?void 0:r.find((function(e){return e.doctorPhone==t.phone})),!i){n.next=5;break}return s["a"].$toast.success("您已收藏成功"),n.abrupt("return");case 5:return n.prev=5,n.next=8,c["a"].addMyFav(a);case 8:s["a"].$toast.success("您已收藏成功"),n.next=14;break;case 11:n.prev=11,n.t0=n["catch"](5),s["a"].$toast.error("收藏 Fail");case 14:case"end":return n.stop()}}),n,null,[[5,11]])})))()},book:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r,a,o,u,d;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.$router.push("/payment"),c["c"].bookItem=t,n.abrupt("return");case 9:return n.sent,s["a"].$toast.success("您已預約成功"),n.next=13,e.getOrderHistory();case 13:return e.docs=Object(i["a"])(e.docs),o=(null===(a=t.orderPhoneNum)||void 0===a?void 0:a.length)>10?t.orderPhoneNum:"U60dea79b6fcd77b9c9e3eeb21fcce0a1",u={id:o},d="你有一筆新訂單NT".concat(r.paidAmount,"元,客戶名稱: ").concat(r.lineClientDisplayName),u.msg=d,n.next=20,c["a"].lineMsg(u);case 20:n.next=25;break;case 22:n.prev=22,n.t0=n["catch"](5),s["a"].$toast.error("order fail"+n.t0);case 25:return n.prev=25,window.orderedDocPhone="",e.loadingApi=!1,n.finish(25);case 29:case"end":return n.stop()}}),n,null,[[5,22,25,29]])})))()},getBooksNum:function(){return 3},viewDetail:function(t){window.scrollTo({top:0,behavior:"smooth"});var e=this.isOrderAble(t);t.status=e?"waiting":"finish",c["c"].selectedDoctor=t,this.$router.push("doctordetails")},getDesc:function(t){return"擅長: "+t.description},getTitle:function(t){return t.name+" | "+t.hospital+" | "+t.title},getImgPath:function(t,e){return c["c"].imgPrefix+t.cover.url},getDocList:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,n=t.id?"doctors?cid_eq="+t.id:"doctors?_limit=30&_start=".concat(t.skip),e.next=4,axios.get(n);case 4:t.docs=e.sent,e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})))()},getOrderHistory:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var n,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(window.lineId){e.next=3;break}return t.myPreviousOrders=[],e.abrupt("return");case 3:return n="orderPhoneNum_eq="+window.lineId,e.next=6,c["a"].getOrders(n);case 6:r=e.sent,r.count,a=r.items,t.myPreviousOrders=a;case 10:case"end":return e.stop()}}),e)})))()}},mounted:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var n,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.$route.query,r=n.id,a=n.searchBy,t.id=+r,t.name=a,t.searchBy=a||"熱門醫生",e.prev=4,t.loadingApi=!0,e.next=8,t.getOrderHistory();case 8:return e.next=10,t.getDocList();case 10:return e.next=12,c["a"].getCancerTypes();case 12:t.cates=e.sent,e.next=18;break;case 15:e.prev=15,e.t0=e["catch"](4),alert("error "+e.t0);case 18:return e.prev=18,t.loadingApi=!1,e.finish(18);case 21:t.getMyFav();case 22:case"end":return e.stop()}}),e,null,[[4,15,18,21]])})))()},watch:{}},d=u,l=(n("52ec"),n("2877")),p=n("5af8"),f=Object(l["a"])(d,r,a,!1,null,"8f2bbae4",null);"function"===typeof p["default"]&&Object(p["default"])(f);e["default"]=f.exports},accc:function(t,e,n){var r=n("23e7"),a=n("64e5");r({target:"Date",proto:!0,forced:Date.prototype.toISOString!==a},{toISOString:a})},d326:function(t,e,n){}}]);
//# sourceMappingURL=chunk-8fc294f4.ac74775d.js.map